<div class="produit-list-container">
    <div class="list-header">
        <h1>Nos Produits</h1>
        <button *ngIf="isAdmin" routerLink="/produits/ajouter" class="btn-primary">Ajouter un produit</button>
    </div>

    <div class="glass-card overflow-hidden">
        <table class="modern-table">
            <thead>
                <tr>
                    <th>Image</th>
                    <th>Nom</th>
                    <th>Boutique</th>
                    <th>Description</th>
                    <th>Prix</th>
                    <th>Stock</th>
                    <th>Type</th>
                    <th>Livraison</th>
                    <th *ngIf="isAdmin || isAcheteur">Actions</th>
                </tr>
            </thead>

            <tbody>
                @for (produit of produits; track produit._id) {
                <tr>
                    <td class="td-image">
                        <img [src]="produit.image_preview || ('http://localhost:5000/' + produit.image_Url)"
                            alt="Image du produit" class="product-thumb" />
                    </td>
                    <td class="font-bold">{{ produit.nom_prod }}</td>
                    <td>{{ produit.store_id?.name || 'Boutique inconnue' }}</td>
                    <td class="td-desc">{{ produit.descriptions }}</td>
                    <td class="price-cell">{{ produit.prix_unitaire.$numberDecimal | number:'1.0-0' }} Ar</td>
                    <td>
                        <span class="badge" [ngClass]="produit.stock_etat ? 'badge-success' : 'badge-danger'">
                            {{ produit.stock_etat ? 'Disponible' : 'Rupture' }}
                        </span>
                    </td>
                    <td>{{ produit.type_produit }}</td>
                    <td>{{ produit.livraison?.disponibilite ? 'Oui' : 'Non' }}</td>
                    <td *ngIf="isAdmin" class="actions-cell">
                        <button [routerLink]="['/produits/modifier', produit._id]" class="btn-icon" title="Modifier">
                            <img src="/img/svg/icon-update.svg" alt="Modifier">
                        </button>
                        <button (click)="deleteProduit(produit._id)" class="btn-icon btn-delete" title="Supprimer">
                            <img src="/img/svg/icon-delete.svg" alt="Supprimer">
                        </button>
                    </td>
                    <td *ngIf="isAcheteur">
                        <button (click)="addToPanier(produit)" class="btn-icon-buy" title="Ajouter au Panier">
                            <i class="fas fa-cart-plus"></i> <img src="/img/svg/icon-cart.svg" alt="Ajouter au Panier">
                        </button>

                    </td>
                </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<script src=""></script>