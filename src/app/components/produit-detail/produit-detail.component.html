<div class="produit-detail-container">
  <!-- Chargement -->
  @if (isLoading) {
    <div style="text-align: center; padding: 40px;">
      <p style="font-size: 16px; color: #007bff;">Chargement...</p>
    </div>
  }

  <!-- Produit trouvé -->
  @if (produit && !isLoading) {
  
    <div style="max-width: 1200px; margin: 0 auto; padding: 20px;">
      <!-- Breadcrumb -->
      <div style="margin-bottom: 20px; font-size: 14px; color: #666;">
        <a routerLink="/produits" style="color: #007bff; text-decoration: none;">Produits</a>
        <span style="margin: 0 10px;">→</span>
        <span>{{ produit.nom_prod }}</span>
      </div>

      <!-- Contenu principal -->
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px;">
        <!-- Image du produit -->
        <div style="background: #f9f9f9; border-radius: 8px; padding: 20px; text-align: center;">
          @if (produit.image_Url) {
            <img 
              [src]="getImageUrl(produit.image_Url)" 
              [alt]="produit.nom_prod"
              style="max-width: 100%; max-height: 400px; border-radius: 8px;"
            />
          } @else {
            <div style="
              width: 100%;
              height: 300px;
              background-color: #e9ecef;
              border-radius: 8px;
              display: flex;
              align-items: center;
              justify-content: center;
              color: #999;
              font-size: 16px;
            ">
              Pas d'image disponible
            </div>
          }
        </div>

        <!-- Infos du produit -->
        <div>
          <h1 style="margin: 0 0 15px 0; font-size: 28px; color: #333;">
            {{ produit.nom_prod }}
          </h1>

          <!-- Prix -->
          <div style="margin-bottom: 20px;">
            <p style="font-size: 14px; color: #666; margin: 0;">Prix</p>
            <p style="font-size: 32px; font-weight: bold; color: #28a745; margin: 10px 0;">
              {{ produit.prix_unitaire?.$numberDecimal || produit.prix_unitaire || 0 | number:'1.0-0' }} Ar
            </p>
          </div>

          <!-- Stock -->
          <div style="margin-bottom: 20px;">
            <span 
              style="
                display: inline-block;
                padding: 8px 15px;
                background-color: #f0f0f0;
                border-radius: 4px;
                font-size: 14px;
                font-weight: bold;
                color: white;
              "
              [style.background-color]="getStockColor()"
            >
              {{ getStockStatus() }}
            </span>
          </div>

          <!-- Description -->
          <div style="margin-bottom: 20px;">
            <h3 style="margin: 0 0 10px 0; font-size: 16px;">Description</h3>
            <p style="font-size: 14px; color: #666; line-height: 1.6; margin: 0;">
              {{ produit.descriptions || 'Pas de description disponible' }}
            </p>
          </div>

          <!-- Boutique -->
          @if (produit.store_id) {
            <div style="margin-bottom: 20px; padding: 15px; background-color: #f9f9f9; border-radius: 8px;">
              <h3 style="margin: 0 0 10px 0; font-size: 16px;">Vendu par</h3>
              <a 
                [routerLink]="['/boutiques', produit.store_id._id || produit.store_id]"
                style="
                  font-size: 16px;
                  color: #007bff;
                  text-decoration: none;
                  font-weight: bold;
                "
              >
                {{ produit.store_id.name || produit.store_id }}
              </a>
            </div>
          }

          <!-- Bouton Ajouter au panier -->
          <button
            [disabled]="!produit.stock_etat"
            style="
              width: 100%;
              padding: 12px;
              background-color: #007bff;
              color: white;
              border: none;
              border-radius: 4px;
              font-size: 16px;
              font-weight: bold;
              cursor: pointer;
              margin-bottom: 15px;
            "
            [style.opacity]="!produit.stock_etat ? '0.5' : '1'"
          >
            {{ produit.stock_etat ? 'Ajouter au panier' : 'Rupture de stock' }}
          </button>
        </div>
      </div>

      <!-- Signalement -->
      @if (isAcheteur) {
        <app-signaler-produit [produitId]="produit._id"></app-signaler-produit>
      }
    </div>
  }

  <!-- Produit non trouvé -->
  @if (!produit && !isLoading) {
    <div style="text-align: center; padding: 40px;">
      <p style="font-size: 16px; color: #dc3545;">Produit non trouvé</p>
      <a routerLink="/produits" style="color: #007bff; text-decoration: underline;">
        Retour à la liste des produits
      </a>
    </div>
  }
</div>