<div class="produit-form-container">
  <div class="glass-card form-card">
    <h1>Modifier le produit</h1>
    <form (ngSubmit)="updateProduit()" class="modern-form">

      <div class="form-group">
        <label for="store_id">Boutique</label>
        <select [(ngModel)]="produit.store_id" name="store_id" class="form-control">
          <option value="">-- Choisir une boutique --</option>
          <option *ngFor="let boutique of boutiques" [value]="boutique._id">
            {{ boutique.name }}
          </option>
        </select>
      </div>

      <div class="form-grid">
        <div class="form-group">
          <label for="nom_prod">Nom du produit</label>
          <input type="text" id="nom_prod" name="nom_prod" [(ngModel)]="produit.nom_prod" class="form-control"
            required />
        </div>

        <div class="form-group">
          <label for="prix_unitaire">Prix unitaire (Ar)</label>
          <input type="number" id="prix_unitaire" name="prix_unitaire" [(ngModel)]="produit.prix_unitaire_val"
            class="form-control" required />
        </div>
      </div>

      <div class="form-group">
        <label for="descriptions">Description</label>
        <textarea id="descriptions" name="descriptions" [(ngModel)]="produit.descriptions" class="form-control"
          rows="4"></textarea>
      </div>

      <div class="form-grid">
        <div class="form-group">
          <label for="stock_etat">Stock disponible ?</label>
          <select [(ngModel)]="produit.stock_etat" name="stock_etat" class="form-control">
            <option [ngValue]="true">Disponible</option>
            <option [ngValue]="false">Rupture de stock</option>
          </select>
        </div>

        <div class="form-group">
          <label for="type_produit">Type de produit</label>
          <select id="type_produit" name="type_produit" [(ngModel)]="produit.type_produit" class="form-control"
            required>
            <option value="PRODUIT">Produit</option>
            <option value="SERVICE">Service</option>
          </select>
        </div>
      </div>

      <div class="form-section">
        <h3>Livraison</h3>
        <div class="form-grid">
          <div class="form-group">
            <label for="livraison_dispo">Livraison disponible ?</label>
            <select id="livraison_dispo" name="livraison_disponibilite" [(ngModel)]="produit.livraison.disponibilite"
              (change)="toggleFraisLivraison()" class="form-control">
              <option [ngValue]="false">Non</option>
              <option [ngValue]="true">Oui</option>
            </select>
          </div>

          <div class="form-group" *ngIf="produit.livraison.disponibilite">
            <label for="frais">Frais de livraison (Ar)</label>
            <input type="number" id="frais" name="livraison_frais" [(ngModel)]="produit.livraison.frais"
              class="form-control" min="0" />
          </div>
        </div>
      </div>

      <div class="form-group">
        <label for="image_Url">Image du produit</label>
        <div class="image-edit-wrapper">
          <div class="file-input-wrapper">
            <input type="file" id="image_Url" name="image_Url" (change)="onImageSelected($event)" class="file-input" />
            <div class="file-input-label">
              <span>ðŸ”„ Remplacer l'image</span>
            </div>
          </div>
          <div class="current-image-preview" *ngIf="produit.image_preview || produit.image_Url">
            <img [src]="produit.image_preview || ('http://localhost:5000/' + produit.image_Url)"
              alt="Image du produit" />
            <span class="preview-label">AperÃ§u actuel</span>
          </div>
        </div>
      </div>

      <div class="form-actions">
        <button type="button" routerLink="/produits" class="btn-secondary">Annuler</button>
        <button type="submit" class="btn-primary">Enregistrer les modifications</button>
      </div>

    </form>
  </div>
</div>